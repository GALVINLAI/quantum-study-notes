# A. First-order derivatives: The gradient

Given rotation-like gates,
\begin{equation}
    U_j(\theta_j) = e^{-(i / 2) H_j \theta_j} = \cos \left(\theta_j / 2\right) \mathbb{1} - i \sin \left(\theta_j / 2\right) H_j
\end{equation}
where $H_j$ is an involutory matrix, i.e., $H_j^2 = \mathbb{1}$. Note the last equality holds only if $H_j$ is involutory.

From the previous identity, the \textbf{unitary conjugation} of an arbitrary operator $\hat{K}$ by $U_j\left(\theta_j\right)$ can always be reduced to the sum of three terms

\begin{equation}
    \hat{K}\left(\theta_j\right)=U_j\left(\theta_j\right)^{\dagger} \hat{K} U_j\left(\theta_j\right)=\hat{A}+\hat{B} \cos \left(\theta_j\right)+\hat{C} \sin \left(\theta_j\right),
\end{equation}

where $\hat{A}, \hat{B}$, and $\hat{C}$ are operators independent of $\theta_j$ and involving only $\hat{K}$ and $\hat{H}_j$.

\begin{proof}
 The conjugate transpose of $U_j(\theta_j)$ is 
\begin{equation}
    U_j(\theta_j)^{\dagger} = \cos \left(\theta_j / 2\right) \mathbb{1} + i \sin \left(\theta_j / 2\right) H_j.
\end{equation}
So,
\begin{equation}
    \hat{K}(\theta_j) = \left( \cos \left(\theta_j / 2\right) \mathbb{1} + i \sin \left(\theta_j / 2\right) H_j \right) \hat{K} \left( \cos \left(\theta_j / 2\right) \mathbb{1} - i \sin \left(\theta_j / 2\right) H_j \right).
\end{equation}
Expanding this product yields
\begin{equation}
    \hat{K}(\theta_j) = \cos^2 \left(\theta_j / 2\right) \hat{K} - i \cos \left(\theta_j / 2\right) \sin \left(\theta_j / 2\right) \hat{K} H_j + i \cos \left(\theta_j / 2\right) \sin \left(\theta_j / 2\right) H_j \hat{K} + \sin^2 \left(\theta_j / 2\right) H_j \hat{K} H_j.
\end{equation}
Using the trigonometric identities:
\begin{equation}
    \cos^2 \left(\theta_j / 2\right) = \frac{1 + \cos(\theta_j)}{2}, \quad \sin^2 \left(\theta_j / 2\right) = \frac{1 - \cos(\theta_j)}{2}, \quad \cos \left(\theta_j / 2\right) \sin \left(\theta_j / 2\right) = \frac{\sin(\theta_j)}{2},
\end{equation}
we have
\begin{equation}
    \hat{K}(\theta_j) = \left( \frac{1 + \cos(\theta_j)}{2} \right) \hat{K} - i \left( \frac{\sin(\theta_j)}{2} \right) \hat{K} H_j + i \left( \frac{\sin(\theta_j)}{2} \right) H_j \hat{K} + \left( \frac{1 - \cos(\theta_j)}{2} \right) H_j \hat{K} H_j.
\end{equation}
Grouping the terms, we obtain:
\begin{equation}
    \hat{K}(\theta_j) = \frac{1}{2} \hat{K} + \frac{1}{2} \cos(\theta_j) \hat{K} - \frac{i}{2} \sin(\theta_j) \hat{K} H_j + \frac{i}{2} \sin(\theta_j) H_j \hat{K} + \frac{1}{2} H_j \hat{K} H_j - \frac{1}{2} \cos(\theta_j) H_j \hat{K} H_j
\end{equation}
Defining $\hat{A}$, $\hat{B}$, and $\hat{C}$ as:
\begin{equation}
    \hat{A} = \frac{1}{2} (\hat{K} + H_j \hat{K} H_j), \quad \hat{B} = \frac{1}{2} (\hat{K} - H_j \hat{K} H_j), \quad \hat{C} = \frac{i}{2} (H_j \hat{K} - \hat{K} H_j)
\end{equation}
Finally, we get:
\begin{equation}
    \hat{K}(\theta_j) = \hat{A} + \hat{B} \cos(\theta_j) + \hat{C} \sin(\theta_j).
\end{equation}
Thus, the unitary conjugation of an arbitrary operator $\hat{K}$ by $U_j(\theta_j)$ can always be reduced to the sum of three terms involving operators $\hat{A}$, $\hat{B}$, and $\hat{C}$ that are independent of $\theta_j$.
\end{proof}

Moreover, from the standard trigonometric addition and subtraction identities, we can deduce that
\begin{equation}
\begin{aligned}
& \frac{d \cos (x)}{d x}=\frac{\cos (x+s)-\cos (x-s)}{2 \sin (s)}, \\
& \frac{d \sin (x)}{d x}=\frac{\sin (x+s)-\sin (x-s)}{2 \sin (s)},
\end{aligned}
\end{equation}
which are valid for any $s \neq k \pi, k \in \mathbb{Z}$.

\begin{proof}
    We only give the poofs for the cosine identity. Recall the addition and subtraction formulas for cosine:
\begin{equation}
\begin{aligned}
& \cos (x+s)=\cos (x) \cos (s)-\sin (x) \sin (s), \\
& \cos (x-s)=\cos (x) \cos (s)+\sin (x) \sin (s).
\end{aligned}
\end{equation}
Hence,
\begin{equation}
    \frac{\cos (x+s)-\cos (x-s)}{2 \sin (s)}=\frac{-2 \sin (x) \sin (s)}{2 \sin (s)}=-\sin (x).
\end{equation}
\end{proof}

Now, differentiate $\hat{K}\left(\theta_j\right)$ with respect to $\theta_j$ :

\begin{align}
\frac{\partial \hat{K}\left(\theta_j\right)}{\partial \theta_j}
&=\hat{B}\frac{\partial \cos \left(\theta_j\right)}{\partial \theta_j} +\hat{C}\frac{\partial \sin \left(\theta_j\right)}{\partial \theta_j} \\
&=\hat{B}\left(\frac{\cos \left(\theta_j+s\right)-\cos \left(\theta_j-s\right)}{2 \sin (s)}\right)+\hat{C}\left(\frac{\sin \left(\theta_j+s\right)-\sin \left(\theta_j-s\right)}{2 \sin (s)}\right).
\end{align}
On the other hand, recognize that $\hat{K}\left(\theta_j \pm s\right)$ can be written in terms of $\cos \left(\theta_j \pm s\right)$ and $\sin \left(\theta_j \pm s\right)$ :
\begin{equation}
\begin{aligned}
\hat{K}\left(\theta_j+s\right) & =\hat{A}+\hat{B} \cos \left(\theta_j+s\right)+\hat{C} \sin \left(\theta_j+s\right) \\
\hat{K}\left(\theta_j-s\right) & =\hat{A}+\hat{B} \cos \left(\theta_j-s\right)+\hat{C} \sin \left(\theta_j-s\right)
\end{aligned}
\end{equation}
Thus,
\begin{equation}
    \frac{\partial \hat{K}\left(\theta_j\right)}{\partial \theta_j}=\frac{\hat{K}\left(\theta_j+s\right)-\hat{K}\left(\theta_j-s\right)}{2 \sin (s)}.
\end{equation}

